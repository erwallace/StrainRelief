requirements_file: null  # strain_relief/requirements.in
conda_env: null  # strain_relief/env.yml
custom_dockerfile: strain_relief/Dockerfile-strain-relief

deployments:
- name: strain_relief

  display_name: ⚕️ Strain Relief

  description: Strain Relief calculates the ligand strain of docked poses and has
    a suite of different force fields with which to do this. This includes a MACE
    neural network potential.

  reference: null

  model_type: scoring

  function: strain_relief.deployment.strain_relief.deployment_function

  config: strain_relief.deployment.strain_relief.DeploymentConfig
  parameters:
    seed:
      type: int
      description: Seed for random number generation.
      default: -1
      nullable: false
    threshold:
      type: float
      description: Threshold for ligand strain filter.
      default: 16.1
      nullable: false
    num_confs:
      type: int
      description: Number of conformers to generate in addition to the given docked pose.
      default: 20
      nullable: false
    minimisation:
      type: string
      description: Force field to use for minimisation. Choose from mmff94, mmff94s, mace.
      default: mace
      nullable: false
    max_iters:
      type: int
      description: Maximum number of iterations for minimisation.
      default: 125
      nullable: false
    model_path:
      type: string
      description: Path to the MACE model.
      default: s3://prescient-data-dev/strain_relief/models/MACE_SPICE2_NEUTRAL.model
      nullable: true

  test: strain_relief/tests/deployment/

  input: [mol_bytes]

  output: [ligand_strain, passes_strain_filter]

  resources:
    gpu: 1
    cpu: 1
    memory: 8Gi
    node_group: gpu-p3_8xlarge
